# Homework2
## 1  
*解*
假定对于二项分布参数p我们采用均匀先验分布，并且在10次试验中观察到了4次正性结果，
a) 给出先验贝塔分布的参数值(2分)
先验贝塔分布的参数值为 $\alpha = 1$ 和 $\beta = 1$.


b) 给出后验贝塔分布的参数值(2分)
后验贝塔分布的参数值为 $\alpha' = 5$ 和 $\beta' = 7$.


c) 给出在先验分布下二项分布参数p的期望值（2分）
先验分布下二项分布参数 $p$ 的期望值为 $\frac{\alpha}{\alpha + \beta} = \frac{1}{2}=0.5$.


d) 给出样本中正性结果的比例(2分)
样本中正性结果的比例为 $\frac{4}{10} = \frac{2}{5}=0.4$.

e) 给出二项分布参数p的极大似然估计值(2分)
二项分布参数 $p$ 的极大似然估计值为 $\frac{4}{10} = \frac{2}{5}=0.4$.


f) 给出在后验分布下二项参数p的期望值，并以先验分布下该参数的期望值和该参数的极大似然估计值的加权平均形式表达(4分)

f) 后验分布下二项分布参数 $p$ 的期望值为 $\frac{\alpha'}{\alpha' + \beta'} = \frac{5}{5 + 7} = \frac{5}{12}$，可以表示为先验分布下该参数的期望值和该参数的极大似然估计值的加权平均形式，即 $\frac{1}{2} \cdot \frac{2}{5} + \frac{2}{5} \cdot \frac{3}{5} =0.44$.


## 2
*解*
假定对于二项分布参数p，我们有三个假设，H0: p = 0.5, H1: p = 0.4, H2: p～unif(0,1)。另外，我们进行了50次伯努利试验，得到了20次正性结果，
a) 求对于每个假设的P(D|H)(6分)
对于每个假设H0: p = 0.5，H1: p = 0.4和H2: p ～ unif(0,1)，我们可以计算给定假设下观察到数据的概率P(D|H)。

对于H0: p = 0.5，我们可以使用二项分布来计算概率。在50次试验中，观察到20次正性结果的概率为：
$$P(D|H_0) = {{50}\choose{20}} \times (0.5^{20}) \times (0.5^{30})$$

对于H1: p = 0.4，同样使用二项分布来计算概率。观察到20次正性结果的概率为：
$$P(D|H_1) = {{50}\choose{20}} \times (0.4^{20}) \times (0.6^{30})$$

对于H2: p ～ unif(0,1)，我们采用均匀先验分布，因此概率为：
P(D|H2) = ∫[0,1] P(D|p) * P(p) dp

由于均匀先验分布为贝塔分布的特例，我们可以使用贝塔分布的边缘似然函数来计算概率。观察到20次正性结果的概率为：
P(D|H2) = ∫[0,1] ${{50}\choose{20}}$ * (p^20) * ((1-p)^30) dp
b) 求各对假设间的贝叶斯因子(3分)
贝叶斯因子可以通过计算每对假设的P(D|H)之间的比值得到。

贝叶斯因子B01 = P(D|H0) / P(D|H1)
贝叶斯因子B02 = P(D|H0) / P(D|H2)
c) 根据以上结果，我们能够做出怎样的统计推断(2分)
根据贝叶斯因子的比较，我们可以确定哪个假设在给定数据下更具有支持性。较大的贝叶斯因子表示一种假设相对于另一种假设更有支持，而较小的贝叶斯因子则表示相反。
d) 为了能够做出接受上述三个假设中某一假设的统计推断，在假定样本正性结果比例不变的情况下，还需进行多少次额外的伯努利试验(5分)
要能够做出接受上述三个假设中某一假设的统计推断，在假定样本正性结果比例不变的情况下，我们需要进行更多的伯努利试验以增加数据量。具体需要多少次额外的伯努利试验取决于我们希望达到的统计推断的可靠程度，以及允许的错误接受率和错误拒绝率等因素。


a) 对于每个假设，我们可以计算 P(D|H)，即在给定假设的条件下观察到数据的概率。

对于假设 H0: p = 0.5，根据二项分布，我们可以计算 P(D|H0) = (n choose k) * p^k * (1-p)^(n-k)，其中 n 是试验次数，k 是正性结果的次数。在这种情况下，n = 50，k = 20，p = 0.5。代入计算得到：
P(D|H0) = (50 choose 20) * 0.5^20 * 0.5^(50-20) ≈ 0.0296

对于假设 H1: p = 0.4，同样根据二项分布，我们可以计算 P(D|H1) = (n choose k) * p^k * (1-p)^(n-k)，其中 n 是试验次数，k 是正性结果的次数。在这种情况下，n = 50，k = 20，p = 0.4。代入计算得到：
P(D|H1) = (50 choose 20) * 0.4^20 * 0.6^(50-20) ≈ 0.0031

对于假设 H2: p ～ unif(0,1)，我们需要考虑先验分布。由于 p 服从均匀分布，先验概率密度函数为 f(p) = 1，0 <= p <= 1。在这种情况下，我们可以计算 P(D|H2) = ∫ P(D|p) * f(p) dp，其中 P(D|p) 是在给定 p 的条件下观察到数据的概率。由于先验分布为均匀分布，积分相当于计算 p 的取值范围 [0,1] 内 P(D|p) 的平均值。根据二项分布，P(D|p) = (n choose k) * p^k * (1-p)^(n-k)，其中 n 是试验次数，k 是正性结果的次数。在这种情况下，n = 50，k = 20。代入计算得到：
P(D|H2) = ∫ P(D|p) * f(p) dp = ∫ (50 choose 20) * p^20 * (1-p)^(50-20) dp ≈ 0.0004

因此，对于每个假设的 P(D|H) 如下：
P(D|H0) ≈ 0.0296
P(D|H1) ≈ 0.0031
P(D|H2) ≈ 0.0004

b) 贝叶斯因子（Bayes factor）用于比较两个假设的相对支持程度。贝叶斯因子可以计算为 P(D|H1) / P(D|H0) 和 P(D|H2) / P(D|H0)。

贝叶斯因子 H1 对 H0 的相对支持程度为 P(D|H1) / P(D|H0) ≈ 0.0031 / 0.0296 ≈ 0.105

贝叶斯因子 H2 对 H0 的相对支持程度为 P(D|H2) / P(D|H0) ≈ 0.0004 / 0.0296 ≈ 0.014

c) 根据以上计算的贝叶斯因子，我们可以推断以下结论：
- 假设 H1（p = 0.4）相对于假设 H0（p = 0.5）具有更弱的支持，因为贝叶斯因子 H1 对 H0 的相对支持程度小于1。
- 假设 H2（p ～ unif(0,1)）相对于假设 H0（p = 0.5）也具有更弱的支持，因为贝叶斯因子 H2 对 H0 的相对支持程度小于1。

d) 为了能够做出接受上述三个假设中某一假设的统计推断，我们可以使用贝叶斯决策规则。根据贝叶斯决策规则，我们应选择具有最大贝叶斯因子的假设。

在这种情况下，由于贝叶斯因子 H1 对 H0 的相对支持程度最大，我们可以做出统计推断，接受假设 H1（p = 0.4）。

对于额外的伯努利试验次数，需要根据先验分布和所需的置信度来确定。如果我们希望进一步减少对假设 H1 的置信度的不确定性，则可以进行更多的伯努利试验以获得更多的数据。具体需要多少次额外的伯努利试验取决于所需的置信度水平和期望的置信区间的宽度。